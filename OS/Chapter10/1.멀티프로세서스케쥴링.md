### 멀티 프로세서 스케쥴링

- 다중 CPU의 문제점

  - 전통적 프로그램은 여전히 하나의 CPU만 사용
  - 응용프로그램을 병렬로 실행되게 다시 작성해야함
  - 멀티 쓰레드 사용

### 여러 CPU에 작업을 어떻게 스케쥴해야할까?

#### 단일 프로세서와 멀티프로세서의 차이?

- 차이가 나타나는 부분
  - 데이터 공유
  - 하드웨어 캐시 방식

### 캐시의 일관성 문제

- 하나의 시스템에 여러 프로세서가 존재하며 하나의 공유 메인메모리가 있을 때
- 캐시 1이 주소 A의 값D를 읽고, 이후 D'으로 갱신 근데 갱신은 캐시 내부에서만 일어남. 캐시 2가 주소 A를 읽으면 D'이 아니라 D가 읽혀짐!
- 해결책
  - 버스 기반 시스템 -> 버스 수ㄴ핑
  - 캐시 데이터의 변경이 발생시 자신의 복사본 무효화

### 동기화

- CPU들이 동일한 데이터 또는 구조체에 접근할 때는 상호 배제를 보장하는 동기화 기법들이 많이 사용
- 락-프리 데이터 구조 방식
- 원자적으로 갱신하기 위해 락이 필요

### 단일 큐 스케쥴링

- 단일 프로세서
- 문제점
  - 확장성 결여
    - 락을 걸면서 더 많은 시간을 소모
  - 캐시 친화성
    - 캐시 친화서을 고려해 스케쥴링하고 다른 작업들은 오버헤드를 균등하게 하기 위함
    - 각 작업이 CPU를 옮겨다닌다고 좋은건 아님!

### 멀티 큐 스케쥴링

- CPU마다 큐를 하나씩 둔다.
- CPU개수 마다 큐를 두므로 락과 캐시의 경합이 문제가 되지 않음
- 캐시 친화적
- 문제
  - 워크로드 불균형
  - CPU가 노는 상태가 발생할 수도

### 이주

- 작업을 한 CPU에서 다른 CPU로 이동함으로써 워클드 균형
- 이주필요여부를 어떻게 결정?
  - 작업 훔치기
    - 작업개수가 낮은 큐가 다른 큐에 훨씬 많은 수의 작업이 있는지 검사

### 리눅스

- O(1),CFS,BFS스케쥴러가 멀티 프로세스 스케쥴러
