## 프로세스

- 실행 중인 프로그램

### cpu가 여러개 존재한다는 환상은 어떻게 제공하는가?

- 적은 개수의 cpu가 있더라도 운영체제는 거의 무한개에 가까운 cpu가 있는듯한 환상을 만든다.

✅ 운영체제는 cpu를 가상화하여 이러한 환상을 만들어낸다.

- 하나 또는 소수의 cpu로 여러개가 있는 듯한 환상을 만들어 내는데 시분할 기법이라 부른다.

- 시분할 기법은 cpu를 공유하기 때문에 각 프로세스의 성능은 낮아진다.
- 다수의 프로그램이 실행될 떄 운영체제가 프로그램을 실행할지에 대한 정책은 스케쥴링 정책이 이러한 결정을 내린다.
  - 과거정보(1분 동안 어떤 프로그램이 자주 실행됐는지, 워크로드에 대한 정보 및 성능측정 이용)

✅ 시분할과 공간분할

- 시분할은 자원공유를 운영체제가 사용하는 가장 기본 기법 중 하나라면 공간분할은 이에 대응 되는 기법이다.
- 디스크는 자연스럽게 공간분할 할 수 있는 자원으로, 블럭이 하나의 파일에 할당되면 파일을 삭제하기 전에는 다른 파일이 할당될 가능성이 낮다.

### 프로세스 개념

- 하드웨어 상태
  - 가장 중요한 구성요소는 메모리
  - 레지스터
    - 프로그램 카운터 : 프로그램의 어느 명령어가 실행중인지 알려줌, 명령어 포인터 (IP)로도 불린다.
    - 스택포인터, 프레임 포인터 : 함수의 변수와 리턴 주소를 저장하는 스택을 관리할때 사용하는 레지스터

### 프로세스 API

- 반드시 제공해야하는 기능은
  - 생성
  - 제거
  - 대기
  - 각종 제어
  - 상태

### 프로세스 상태

- 실행 : 프로세스는 명령어 실행 중
- 준비 : 프로세스는 실행할 준비가 되어있지만 운영체제가 다른 프로세스를 실행하고 있는 등의 이유로 대기 중
- 대기 : 프로세스가 다른 사건을 기다리는 동안 프로세스의 수행을 중단시킴 (프로세스가 디스크 입출력 요청시 -> 프로세스는 입출력이 완료될때 까지 대기)
- 초기 : 프로세스가 완전히 생성되기 전 까지의 상태
- 최종 : 프로세스는 종료되었지만 해당 프로세스가 사용한 자원들이 아직 완전히 반납되지 않은 상태 (final 이라고도 함)
- xv6의 Proc구조를 참고

### 프로세스의 자료구조

- 프로세스 상태를 파악하기 위해 준비 상태의 프로세스 들을 위한 프로세스 리스트 가짐
- 현재 프로세스 실행 중 프로세스를 명시하기 위한 부가적인 자료구조도 유지
- 레지스터 문맥 자료구조 : 프로세스가 중단되었을 때 해당 프로세스의 레지스터값들을 저장 -> 이 레지스터 값들을 복원하여 운영체제는 프로세스 실행을 재개
- 이를 문맥교환이라고 함.
